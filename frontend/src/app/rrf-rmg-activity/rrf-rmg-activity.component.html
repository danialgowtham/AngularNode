<hr class="mg-b-5-force">
<div *ngIf="view_type=='rmg'">
  <input type="file" #file style="display: none" />
  <div class="mg-t-10 mg-b-10">
    <span class="slim-card-title pd-l-10">Upload Candidate</span>
  </div>
  <form [formGroup]="form_data">
    <div class="form-group border-0 pd-0-force">
      <div class="row no-gutters">
        <div class="col-md-3">
          <div class="form-group filter_class mg-md-l--1 bd-t-0-force border-0 pd-10-force">
            <label class="form-control-label tx-bold">Candidate Name</label>
            <mat-form-field class="col-12 pd-0" appearance="outline">
              <mat-label>Enter Candidate Name</mat-label>
              <input formControlName="candidate_name" class="form-control wd-100p-force border-0" matInput>
              <mat-error *ngIf="form_data.controls.candidate_name.hasError('required')">
                Candidate Name is <strong>required</strong>
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group filter_class mg-md-l--1 bd-t-0-force border-0 pd-10-force">
            <label class="form-control-label tx-bold">Candidate Email ID</label>
            <mat-form-field class="col-12 pd-0" appearance="outline">
              <mat-label>Enter Candidate Email ID</mat-label>
              <input type="email" formControlName="candidate_email" class="form-control wd-100p-force border-0"
                matInput>
              <mat-error *ngIf="form_data.controls.candidate_email.hasError('required')">
                Candidate Email ID is <strong>required</strong>
              </mat-error>
              <mat-error *ngIf="form_data.controls.candidate_email.hasError('pattern')">
                Invalid Email ID
              </mat-error>
            </mat-form-field>
            <mat-error *ngIf="duplicate_error_flag">
              Candidate Email Already Available
            </mat-error>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group filter_class mg-md-l--1 bd-t-0-force border-0 pd-10-force">
            <label class="form-control-label tx-bold">Resume<span class="mg-l-10 tx-danger"
                style="text-transform: capitalize;">Only PDF/Doc</span></label>
            <mat-form-field class="col-12 pd-0" appearance="outline">
              <mat-label>Choose Resume</mat-label>
              <ngx-mat-file-input class="cursor-pointer" placeholder="Choose Resume" formControlName="resume">
              </ngx-mat-file-input>
              <mat-icon matSuffix>folder</mat-icon>
              <mat-error *ngIf="form_data.get('resume').hasError('maxContentSize')">
                File size must be less than
                {{form_data.get('resume')?.getError('maxContentSize').maxSize | byteFormat}}
              </mat-error>
              <mat-error *ngIf="form_data.get('resume').hasError('required')">
                Resume is <strong>required</strong>
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group filter_class mg-md-l--1 bd-t-0-force border-0 pd-10-force">
            <label class="form-control-label tx-bold">Candidate Basic Information</label>
            <mat-form-field class="col-12 pd-0" appearance="outline">
              <mat-label>Enter Candidate Basic Information</mat-label>
              <textarea formControlName="candidate_basic_information" rows="3" matInput></textarea>
              <!-- <mat-error *ngIf="form_data.controls.candidate_name.hasError('required')">
                Candidate Basic Information is <strong>required</strong>
              </mat-error> -->
            </mat-form-field>
          </div>
        </div>
        <div class="col-md-3 text-center" style="margin-top: 50px">
          <button mat-raised-button (click)="add_candidate()" color="primary">Add</button>
          <button mat-raised-button (click)="reset_form()" color="warn" class="mg-l-20-force">Cancel</button>
        </div>
      </div>
    </div>
  </form>
</div>
<hr class="mg-b-5-force">
<div>
  <div class="mg-t-10 mg-b-10">
    <span class="slim-card-title pd-l-10">Candidate Detail</span>
  </div>
  <div class="row no-gutters">
    <div class="col-md-12 pd-l-10-force pd-r-10-force ">
      <table mat-table (mouseleave)="expandedElement = null" [dataSource]="candidate_detail" multiTemplateDataRows
        class="wd-100p section-wrapper">
        <ng-container matColumnDef="candidate_name">
          <th mat-header-cell *matHeaderCellDef class="wd-20p"> Candidate Name </th>
          <td mat-cell *matCellDef="let element;">{{element?.candidate_name}} </td>
        </ng-container>
        <ng-container matColumnDef="candidate_email">
          <th mat-header-cell *matHeaderCellDef class="wd-20p"> Candidate Email </th>
          <td mat-cell *matCellDef="let element;">{{element?.candidate_email}} </td>
        </ng-container>
        <ng-container matColumnDef="expandedDetail">
          <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
            <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
              <div class="example-element-description pd-l-0-force">
                <div>
                  <span>
                    <label class="tx-medium tx-13">Candidate Basic Information : </label>
                    <span class="mg-l-10">
                      {{element?.candidate_basic_information}}
                    </span>
                  </span>
                </div>
              </div>

              <div class="row" *ngIf="element.status=='RMG Approved'">
                <div class="col-md-3 pd-0-force">
                  <div class="form-group filter_class mg-md-l--1 bd-t-0-force border-0">
                    <mat-form-field class="col-12 pd-0" appearance="outline">
                      <mat-label>Enter Grand CTC</mat-label>
                      <input (keypress)="keyPress($event)" [formControl]="grand_ctc"
                        class="form-control wd-100p-force border-0" matInput>
                    </mat-form-field>
                  </div>
                </div>
                <div class="col-md-3 pd-0-force">
                  <div class="form-group filter_class mg-md-l--1 bd-t-0-force border-0">
                      <button [disabled]="!grand_ctc.valid" class="mg-t-2-force" (click)="generate_offer_letter(element?._id)" mat-raised-button color="primary">Generate Offer Letter</button>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </ng-container>
        <ng-container matColumnDef="resume">
          <th mat-header-cell *matHeaderCellDef class="wd-10p"> Resume </th>
          <td mat-cell *matCellDef="let element">
            <!--  -->
            <a [href]="BACK_END_URL+element?.resume" target="_blank" download>
              <span class="">
                {{element?.candidate_name}} Resume
              </span>
            </a>
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef class="wd-20p"> Status </th>
          <td mat-cell *matCellDef="let element"> {{element?.status}} </td>
        </ng-container>
        <ng-container matColumnDef="iof_detail">
          <th mat-header-cell *matHeaderCellDef class="wd-20p"> IOF </th>
          <td mat-cell *matCellDef="let element">
            <span *ngFor="let item of element?.interview_schedule">
              <li *ngIf="item?.iof_detail" class="text-primary cursor-pointer"
                (click)="openIOF(item?.iof_detail,'technical')">Level
                -
                {{item.level+1}} IOF
              </li>
            </span>
            <li *ngIf="element?.hr_iof_detail" class="text-primary cursor-pointer"
              (click)="openIOF(element?.hr_iof_detail,'hr')">
              HR IOF
            </li>
          </td>
        </ng-container>
        <ng-container matColumnDef="interview_schedule">
          <th mat-header-cell *matHeaderCellDef class="wd-10p"> Schedule Interview</th>
          <td class="cursor-pointer tx-15 text-center" mat-cell *matCellDef="let element;let i = index;">
            <span *ngIf="element?.interview_schedule.length>0">
              <i class="fa fa-eye" (click)="openInterviewSchedule('view',element?.interview_schedule,element?._id)"></i>
            </span>
            <span *ngIf="view_type =='rmg' ">
              <i class="fa fa-edit mg-l-5"
                (click)="openInterviewSchedule('edit',element?.interview_schedule,element?._id)"></i>
            </span>
          </td>
        </ng-container>
        <ng-container matColumnDef="file_upload">
            <th mat-header-cell *matHeaderCellDef class="wd-10p"> File Upload</th>
            <td class="cursor-pointer tx-15 text-center" mat-cell *matCellDef="let element;">
              <a *ngIf="element?.status=='Technical Round Cleared'" [href]="FRONT_END_URL+'candidate_file_upload;candidate_id='+element?._id" target="_blank">
                <i class="fa fa-paper-plane" ></i>
              </a>
            </td>
          </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let element; columns: displayedColumns;" class="example-element-row"
          [class.example-expanded-row]="expandedElement === element" (mouseenter)="expandedElement = element">
        </tr>
        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
      </table>
      <mat-paginator #candidate_paginator class="wd-100p border border-top-0" [pageSizeOptions]="[10, 20, 30]"
        showFirstLastButtons></mat-paginator>
    </div>
  </div>
</div>